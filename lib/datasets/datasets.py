from .thumos_data_layer import TRNTHUMOSDataLayer
from .thumos_data_layer_e2e import TRNTHUMOSDataLayerE2E
from .judo_data_layer import TRNJUDODataLayer
from .judo_data_layer_e2e import TRNJUDODataLayerE2E

_DATA_LAYERS = {
    'TRNTHUMOS': TRNTHUMOSDataLayer,
    'TRNTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'LSTMTHUMOS': TRNTHUMOSDataLayer,
    'LSTMTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'GRUTHUMOS': TRNTHUMOSDataLayer,
    'GRUTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'CNN3DTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'DISCRIMINATORLSTMTHUMOS': TRNTHUMOSDataLayer,
    'DISCRIMINATORLSTMTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'DISCRIMINATORCNN3DTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'DISCRIMINATORCNNTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'CONVLSTMTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'CONVLSTMTHUMOS': TRNTHUMOSDataLayer,
    'CNNTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'IDUTHUMOS': TRNTHUMOSDataLayer,
    'IDUTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'STARTENDLSTMTHUMOS': TRNTHUMOSDataLayer,
    'LSTMATTENTIONTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'LSTMATTENTIONTHUMOS': TRNTHUMOSDataLayer,
    'GRUATTENTIONTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'GRUATTENTIONTHUMOS': TRNTHUMOSDataLayer,
    'DCCLSTMTHUMOS': TRNTHUMOSDataLayer,
    'DCCGRUTHUMOS': TRNTHUMOSDataLayer,

    'TRNJUDO': TRNJUDODataLayer,
    'TRNJUDOE2E': TRNJUDODataLayerE2E,
    'LSTMJUDO': TRNJUDODataLayer,
    'LSTMJUDOE2E': TRNJUDODataLayerE2E,
    'GRUJUDO': TRNJUDODataLayer,
    'GRUJUDOE2E': TRNJUDODataLayerE2E,
    'CNN3DJUDOE2E': TRNJUDODataLayerE2E,
    'CNNJUDOE2E': TRNJUDODataLayerE2E,
    'CONVLSTMJUDO': TRNJUDODataLayer,
    'TWOLAYERSGRUJUDO': TRNJUDODataLayer,
}

def build_dataset(args, phase):
    data_layer = _DATA_LAYERS[args.model + args.dataset + args.E2E]
    return data_layer(args, phase)
