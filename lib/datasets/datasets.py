from .thumos_data_layer import TRNTHUMOSDataLayer
from .thumos_data_layer_e2e import TRNTHUMOSDataLayerE2E

_DATA_LAYERS = {
    'TRNTHUMOS': TRNTHUMOSDataLayer,
    'TRNTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'LSTMTHUMOS': TRNTHUMOSDataLayer,
    'LSTMTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'CNN3DTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'DISCRIMINATORLSTMTHUMOS': TRNTHUMOSDataLayer,
    'DISCRIMINATORLSTMTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'DISCRIMINATORCNN3DTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'DISCRIMINATORCNNTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'CONVLSTMTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'CNNTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'IDUTHUMOS': TRNTHUMOSDataLayer,
    'STARTENDLSTMTHUMOS': TRNTHUMOSDataLayer,
    'LSTMATTENTIONTHUMOSE2E': TRNTHUMOSDataLayerE2E,
    'LSTMATTENTIONTHUMOS': TRNTHUMOSDataLayer,
    'TCLSTMTHUMOS': TRNTHUMOSDataLayer,
}

def build_dataset(args, phase):
    data_layer = _DATA_LAYERS[args.model + args.dataset + args.E2E]
    return data_layer(args, phase)
